language: ruby
rvm:
- 2.4.1
install: gem install travis --no-rdoc --no-ri
sudo: false
env:
  global:
    secure: ICBPrT2xP+Vf1/Ejh5G+qUHbDuzhVRKokVSi379xWhrydBp0o0W6LsrbZx0SQOahEmOWLnBuu444XK9PCg27GToP/Sq5F34QhIFE1bGQ/XxjTK/rfXYpd8bHwgQAaJHMZolZdolabw8xcruJx8ZTzNbGflGvqa0q3ENGdx5rLtCJHPZXjT06iTQt5K5HazQHfTrNVJbV+U07hNa8OFDjNvLtpIeXloAjm0WGMrisEUPMVBRkDq2mNoZ/73avWkQjkbzOQMkorPyA367sQQqaWIKqfnrJqsMLHEFEM6RON9H6NlJFPHYEHnh0u4PUoD6MXBZ3Z5wPW+JL3JA8VemhX58xWsYS0o/OnO6f22e+CzOdHawo5EXRQDnBbzrSASLb3ywqEY86edHZq5QlcuFCing8EEEwQuESwl+Jxa8LEfLYiNbso+S5gVw3kIWHVV+iKGz3rkVSc2LPYvm+zFcDM16fxVBZYROdgQLw9ynzWxnyoEscRKxRFAFhVVJhyg+VI8VxkSBowF1pVfPU9PIOIbj2f/b1PTu3vvCE3b36xf7/WNwhfiOfQLjw4LglJVHTu7Wkql3yWJ3JbiNNifjPIa4v9+jsBZ2siz6UlZRDAwnCKph62Cm5se0VdpGlQpViMlKWOf1h+yijXkXxO+aUaNsz0QPyjyjSVdrGKuZiuqI=
script: >
  if [ ! -z $GITHUB_TRAVIS_TOKEN ]; then
    echo "Start requesting a travis build from upstream repository...";
    # Doesn't use --debug on `travis login`.  --debug will show the github token
    # travis login --skip-completion-check --org --github-token "$GITHUB_TRAVIS_TOKEN";
    export TRAVIS_ACCESS_TOKEN=`travis login --skip-completion-check --org --github-token $GITHUB_TRAVIS_TOKEN && travis token`;
    UPSTREAM_REPO_SLUG="kinueng%2Fopenliberty.io"
    echo $TRAVIS_COMMIT_MESSAGE
    body='{
        "request": {
            "message": "Build request from static guide",
            "branch":"development"
        }}'
    curl -s -S -f -X POST \
        -H "Content-Type: application/json" \
        -H "Accept: application/json" \
        -H "Travis-API-Version: 3" \
        -H "Authorization: token $TRAVIS_ACCESS_TOKEN" \
        -d "$body" \
        https://api.travis-ci.org/repo/$UPSTREAM_REPO_SLUG/requests

    echo "SUCCESS: Completed request for travis build from upstream repository...";
  else
    echo "ERROR: Missing Github token.  Cannot request a travis build for upstream repository...";
  fi